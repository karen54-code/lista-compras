<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gest√£o - Restaurante</title>
    <style>
        :root {
            --verde-escuro: #2b4d2b;
            --verde-medio: #4e7d4e;
            --verde-claro: #b7d7b7;
            --bege: #f6f3e7;
            --branco: #fff;
            --cinza: #e9ecef;
            --azul: #0066cc;
            --vermelho: #dc3545;
            --amarelo: #ffc107;
            --whatsapp: #25D366;
            --roxo: #6f42c1;
            --laranja: #fd7e14;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--bege) 0%, var(--verde-claro) 100%);
            min-height: 100vh;
            color: var(--verde-escuro);
        }

        .container {
            max-width: 450px;
            margin: 0 auto;
            background: var(--branco);
            min-height: 100vh;
            box-shadow: 0 0 20px rgba(43,77,43,0.08);
            position: relative;
        }

        .header {
            background: linear-gradient(135deg, var(--verde-escuro), var(--verde-medio));
            color: var(--bege);
            padding: 20px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(43,77,43,0.08);
        }

        .header h1 {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .header .subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .login-screen {
            padding: 40px 20px;
            text-align: center;
        }

        .sector-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 30px 0;
        }

        .sector-btn {
            background: linear-gradient(135deg, var(--verde-medio), var(--verde-escuro));
            color: var(--bege);
            border: none;
            padding: 20px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s;
        }

        .sector-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(78,125,78,0.15);
        }

        .sector-btn.geral {
            background: linear-gradient(135deg, var(--laranja), #e0570c);
            grid-column: span 2;
        }

        .tabs {
            display: flex;
            background: var(--bege);
            border-bottom: 1px solid var(--cinza);
            overflow-x: auto;
        }

        .tab {
            flex: 1;
            padding: 15px 10px;
            text-align: center;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            color: var(--verde-escuro);
            font-size: 14px;
            min-width: 100px;
        }

        .tab.active {
            background: var(--branco);
            border-bottom-color: var(--verde-medio);
            color: var(--verde-medio);
        }

        .tab-content {
            display: none;
            padding: 20px;
            padding-bottom: 100px;
        }

        .tab-content.active {
            display: block;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            max-height: 80vh;
            overflow-y: auto;
        }

        .form-group {
            margin-bottom: 20px;
            position: relative;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--verde-escuro);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--cinza);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--verde-medio);
        }

        .btn {
            background: linear-gradient(135deg, var(--verde-medio), var(--verde-escuro));
            color: var(--bege);
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            width: 100%;
            transition: all 0.3s;
            margin-bottom: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(78,125,78,0.15);
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745, #20c997);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--vermelho), #c82333);
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--amarelo), #e0a800);
            color: var(--verde-escuro);
        }

        .btn-whatsapp {
            background: linear-gradient(135deg, var(--whatsapp), #128C7E);
            color: white;
        }

        .btn-info {
            background: linear-gradient(135deg, var(--azul), #004d99);
            color: white;
        }

        .btn-purple {
            background: linear-gradient(135deg, var(--roxo), #5a32a3);
            color: white;
        }

        .btn-orange {
            background: linear-gradient(135deg, var(--laranja), #e0570c);
            color: white;
        }

        .btn-small {
            padding: 8px 12px;
            font-size: 14px;
            width: auto;
            margin: 2px;
        }

        .item-card {
            background: var(--branco);
            border: 2px solid var(--cinza);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            transition: all 0.3s;
        }

        .item-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .item-name {
            font-weight: 600;
            font-size: 16px;
            flex: 1;
        }

        .item-details {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            color: var(--verde-medio);
            margin-bottom: 10px;
        }

        .item-actions {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--verde-escuro);
            color: var(--bege);
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(43,77,43,0.15);
            transform: translateX(100%);
            transition: transform 0.3s;
            z-index: 1100;
        }

        .notification.show {
            transform: translateX(0);
        }

        .sector-info {
            background: var(--verde-claro);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: var(--branco);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid var(--cinza);
        }

        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: var(--verde-escuro);
        }

        .stat-label {
            font-size: 12px;
            color: var(--verde-medio);
            margin-top: 5px;
        }

        .inventory-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: var(--branco);
            border: 2px solid var(--cinza);
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .inventory-item.low-stock {
            border-color: var(--amarelo);
            background: #fff3cd;
        }

        .inventory-item.out-of-stock {
            border-color: var(--vermelho);
            background: #f8d7da;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quantity-btn {
            width: 30px;
            height: 30px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
        }

        .quantity-display {
            min-width: 50px;
            text-align: center;
            font-weight: bold;
        }

        .history-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
        }

        .history-item-details {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .history-item-status {
            font-weight: bold;
        }

        .history-item-notes {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .modal-actions .btn {
            flex: 1;
            margin-bottom: 0;
        }

        .suggestions-container {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid var(--cinza);
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }

        .suggestion-item {
            padding: 10px;
            cursor: pointer;
            border-bottom: 1px solid var(--cinza);
        }

        .suggestion-item:hover {
            background-color: var(--verde-claro);
        }

        .suggestion-category {
            background-color: var(--bege);
            padding: 5px 10px;
            font-weight: bold;
            color: var(--verde-escuro);
        }

        .purchase-status {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }

        .status-btn {
            padding: 8px 12px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-weight: 500;
        }

        .status-found {
            background-color: #d4edda;
            color: #155724;
        }

        .status-not-found {
            background-color: #f8d7da;
            color: #721c24;
        }

        .status-partial {
            background-color: #fff3cd;
            color: #856404;
        }

        .price-input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 5px 0;
        }

        .recipe-card {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .recipe-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--verde-escuro);
        }

        .recipe-ingredients {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
        }

        .recipe-instructions {
            font-size: 14px;
            color: #444;
        }

        .shopping-list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: var(--branco);
            border: 2px solid var(--cinza);
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .shopping-item-info {
            flex: 1;
        }

        .shopping-item-name {
            font-weight: bold;
        }

        .shopping-item-quantity {
            font-size: 14px;
            color: #666;
        }

        .shopping-item-actions {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .filter-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            overflow-x: auto;
            padding-bottom: 5px;
        }

        .filter-btn {
            padding: 8px 12px;
            border-radius: 20px;
            border: 2px solid var(--cinza);
            background: var(--branco);
            cursor: pointer;
            white-space: nowrap;
        }

        .filter-btn.active {
            background: var(--verde-medio);
            color: white;
            border-color: var(--verde-medio);
        }

        .quantity-unit {
            display: flex;
            gap: 10px;
        }

        .quantity-input {
            flex: 2;
        }

        .unit-select {
            flex: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Tela de Login -->
        <div id="loginScreen" class="login-screen">
            <div class="header">
                <h1>Sistema de Gest√£o</h1>
                <div class="subtitle">Restaurante</div>
            </div>
            
            <h2 style="margin-bottom: 30px;">Selecione seu Setor</h2>
            
            <div class="sector-buttons">
                <button class="sector-btn" onclick="showPasswordModal('cozinha')">
                    üç≥ Cozinha
                </button>
                <button class="sector-btn" onclick="showPasswordModal('lavanderia')">
                    üëï Lavanderia
                </button>
                <button class="sector-btn" onclick="showPasswordModal('limpeza')">
                    üßπ Limpeza
                </button>
                <button class="sector-btn" onclick="showPasswordModal('bar')">
                    üç∫ Bar
                </button>
                <button class="sector-btn" onclick="showPasswordModal('escritorio')">
                    üíº Escrit√≥rio
                </button>
                <button class="sector-btn" onclick="showPasswordModal('area_externa')">
                    üå≥ √Årea Externa
                </button>
                <button class="sector-btn" onclick="showPasswordModal('compras')">
                    üõí Compras
                </button>
                <button class="sector-btn geral" onclick="showPasswordModal('geral')">
                    üåü Lista Geral (Administrador)
                </button>
            </div>
        </div>

        <!-- Sistema Principal -->
        <div id="mainSystem" style="display: none;">
            <div class="header">
                <h1>Sistema de Gest√£o</h1>
                <div class="subtitle" id="currentSector">Setor</div>
                <button onclick="logout()" style="position: absolute; right: 15px; top: 15px; background: rgba(255,255,255,0.2); border: none; color: white; padding: 8px; border-radius: 50%; cursor: pointer;">
                    ‚Ü©Ô∏è
                </button>
            </div>

            <div class="sector-info" id="sectorInfo">
                <strong id="sectorName">Setor</strong>
                <div id="sectorStats"></div>
            </div>

            <div class="tabs">
                <button class="tab active" onclick="switchTab('lista')">Lista</button>
                <button class="tab" onclick="switchTab('inventario')">Invent√°rio</button>
                <button class="tab" onclick="switchTab('historico')">Hist√≥rico</button>
                <button class="tab" onclick="switchTab('compras')" id="comprasTab" style="display: none;">üõí Compras</button>
                <button class="tab" onclick="switchTab('receitas')" id="receitasTab" style="display: none;">üç≥ Receitas</button>
            </div>

            <!-- Aba Lista -->
            <div id="lista" class="tab-content active">
                <button class="btn" onclick="showAddItemModal()" style="margin-bottom: 20px;">
                    ‚ûï Adicionar Item
                </button>

                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-number" id="totalItems">0</div>
                        <div class="stat-label">Total</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="pendingItems">0</div>
                        <div class="stat-label">Pendentes</div>
                    </div>
                </div>

                <div id="itemsList"></div>

                <button class="btn btn-success" onclick="finalizeList()" style="margin-top: 20px;">
                    ‚úÖ Finalizar Lista
                </button>
            </div>

            <!-- Aba Invent√°rio -->
            <div id="inventario" class="tab-content">
                <button class="btn" onclick="showAddInventoryModal()" style="margin-bottom: 20px;">
                    üì¶ Adicionar ao Invent√°rio
                </button>

                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-number" id="totalInventory">0</div>
                        <div class="stat-label">Itens</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="lowStockItems">0</div>
                        <div class="stat-label">Estoque Baixo</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="outOfStockItems">0</div>
                        <div class="stat-label">Sem Estoque</div>
                    </div>
                </div>

                <div id="inventoryList"></div>
            </div>

            <!-- Aba Hist√≥rico -->
            <div id="historico" class="tab-content">
                <div id="historyList"></div>
            </div>

            <!-- Aba Compras -->
            <div id="compras" class="tab-content">
                <div class="sector-info">
                    <h3>Lista de Compras Autorizada</h3>
                    <p>Itens pendentes para compra hoje</p>
                </div>

                <div class="filter-buttons">
                    <button class="filter-btn active" onclick="filterShoppingList('todos')">Todos</button>
                    <button class="filter-btn" onclick="filterShoppingList('cozinha')">Cozinha</button>
                    <button class="filter-btn" onclick="filterShoppingList('bar')">Bar</button>
                    <button class="filter-btn" onclick="filterShoppingList('limpeza')">Limpeza</button>
                </div>

                <button class="btn btn-info" onclick="mergeShoppingLists()" style="margin-bottom: 15px;">
                    üîÑ Mesclar Listas do Dia
                </button>

                <div id="shoppingList"></div>

                <div class="modal-actions">
                    <button class="btn btn-success" onclick="finalizeShopping()">
                        ‚úÖ Finalizar Compra
                    </button>
                    <button class="btn btn-whatsapp" onclick="shareShoppingList()">
                        üì§ Enviar por WhatsApp
                    </button>
                </div>
            </div>

            <!-- Aba Receitas -->
            <div id="receitas" class="tab-content">
                <div class="sector-info">
                    <h3>üç≥ Sugest√µes de Receitas</h3>
                    <p>Receitas baseadas nos itens dispon√≠veis</p>
                </div>

                <button class="btn btn-purple" onclick="generateRecipes()" style="margin-bottom: 20px;">
                    üß† Gerar Sugest√µes de Receitas
                </button>

                <div id="recipesList"></div>
            </div>
        </div>
    </div>

    <!-- Modal de Senha -->
    <div id="passwordModal" class="modal">
        <div class="modal-content">
            <h3 style="margin-bottom: 20px;">Digite a senha do setor</h3>
            <div class="form-group">
                <label>Senha:</label>
                <input type="password" id="passwordInput" placeholder="Digite a senha">
            </div>
            <button class="btn" onclick="authenticate()">Entrar</button>
            <button class="btn btn-danger" onclick="closeModal('passwordModal')">Cancelar</button>
        </div>
    </div>

    <!-- Modal Adicionar Item -->
    <div id="addItemModal" class="modal">
        <div class="modal-content">
            <h3 style="margin-bottom: 20px;">Adicionar Item</h3>
            <div class="form-group">
                <label>Nome do Item:</label>
                <input type="text" id="itemName" placeholder="Ex: Arroz" oninput="showSuggestions(this.value, 'item')">
                <div id="itemSuggestions" class="suggestions-container"></div>
            </div>
            <div class="form-group">
                <label>Quantidade e Unidade:</label>
                <div class="quantity-unit">
                    <input type="number" id="itemQuantity" placeholder="Quantidade" class="quantity-input" min="1" step="0.1">
                    <select id="itemUnit" class="unit-select">
                        <option value="un">Unidade</option>
                        <option value="kg">Quilograma (kg)</option>
                        <option value="g">Grama (g)</option>
                        <option value="l">Litro (l)</option>
                        <option value="ml">Mililitro (ml)</option>
                        <option value="pct">Pacote</option>
                        <option value="cx">Caixa</option>
                        <option value="dz">D√∫zia</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label>Prioridade:</label>
                <select id="itemPriority">
                    <option value="normal">Normal</option>
                    <option value="alta">Alta</option>
                    <option value="urgente">Urgente</option>
                </select>
            </div>
            <div class="form-group">
                <label>Observa√ß√µes:</label>
                <textarea id="itemNotes" placeholder="Observa√ß√µes adicionais"></textarea>
            </div>
            <button class="btn btn-success" onclick="addItem()">Adicionar</button>
            <button class="btn btn-danger" onclick="closeModal('addItemModal')">Cancelar</button>
        </div>
    </div>

    <!-- Modal Adicionar Invent√°rio -->
    <div id="addInventoryModal" class="modal">
        <div class="modal-content">
            <h3 style="margin-bottom: 20px;">Adicionar ao Invent√°rio</h3>
            <div class="form-group">
                <label>Nome do Item:</label>
                <input type="text" id="inventoryItemName" placeholder="Ex: Detergente" oninput="showSuggestions(this.value, 'inventory')">
                <div id="inventorySuggestions" class="suggestions-container"></div>
            </div>
            <div class="form-group">
                <label>Quantidade Atual:</label>
                <input type="number" id="inventoryQuantity" placeholder="0" min="0">
            </div>
            <div class="form-group">
                <label>Quantidade M√≠nima:</label>
                <input type="number" id="inventoryMinQuantity" placeholder="5" min="0">
            </div>
            <div class="form-group">
                <label>Unidade:</label>
                <input type="text" id="inventoryUnit" placeholder="Ex: unidades, kg, litros">
            </div>
            <button class="btn btn-success" onclick="addInventoryItem()">Adicionar</button>
            <button class="btn btn-danger" onclick="closeModal('addInventoryModal')">Cancelar</button>
        </div>
    </div>

    <!-- Modal de Detalhes do Hist√≥rico -->
    <div id="historyDetailsModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <h3 id="historyDetailsTitle" style="margin-bottom: 20px;">Detalhes da Lista</h3>
            <div id="historyDetailsContent"></div>
            <div class="modal-actions">
                <button class="btn btn-whatsapp" onclick="shareToWhatsApp()">
                    üì§ Compartilhar no WhatsApp
                </button>
                <button class="btn btn-danger" onclick="closeModal('historyDetailsModal')">Fechar</button>
            </div>
        </div>
    </div>

    <!-- Modal de Status de Compra -->
    <div id="purchaseStatusModal" class="modal">
        <div class="modal-content">
            <h3 id="purchaseItemTitle" style="margin-bottom: 20px;">Status de Compra</h3>
            <input type="hidden" id="purchaseItemId">
            
            <div class="purchase-status">
                <button class="status-btn status-found" onclick="setPurchaseStatus('encontrado')">‚úÖ Encontrado</button>
                <button class="status-btn status-not-found" onclick="setPurchaseStatus('nao_encontrado')">‚ùå N√£o Encontrado</button>
                <button class="status-btn status-partial" onclick="setPurchaseStatus('parcial')">üîÑ Quantidade Diferente</button>
            </div>
            
            <div id="quantitySection" style="display: none; margin-top: 15px;">
                <div class="form-group">
                    <label>Quantidade Comprada:</label>
                    <div class="quantity-unit">
                        <input type="number" id="purchasedQuantity" placeholder="Quantidade" class="quantity-input" min="0" step="0.1">
                        <select id="purchasedUnit" class="unit-select">
                            <option value="un">Unidade</option>
                            <option value="kg">Quilograma (kg)</option>
                            <option value="g">Grama (g)</option>
                            <option value="l">Litro (l)</option>
                            <option value="ml">Mililitro (ml)</option>
                            <option value="pct">Pacote</option>
                            <option value="cx">Caixa</option>
                            <option value="dz">D√∫zia</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label>Pre√ßo Unit√°rio (opcional):</label>
                <input type="number" step="0.01" id="itemPrice" placeholder="R$ 0,00">
            </div>
            
            <div class="form-group">
                <label>Observa√ß√µes:</label>
                <textarea id="purchaseNotes" placeholder="Observa√ß√µes sobre a compra"></textarea>
            </div>
            
            <button class="btn btn-success" onclick="savePurchaseStatus()">Salvar</button>
            <button class="btn btn-danger" onclick="closeModal('purchaseStatusModal')">Cancelar</button>
        </div>
    </div>

    <!-- Notifica√ß√£o -->
    <div id="notification" class="notification"></div>

    <script>
        // Configura√ß√£o de senhas por setor (todas 123)
        const sectorPasswords = {
            'cozinha': '123',
            'lavanderia': '123',
            'limpeza': '123',
            'bar': '123',
            'escritorio': '123',
            'area_externa': '123',
            'compras': '123',
            'geral': '123'
        };

        const sectorNames = {
            'cozinha': 'Cozinha',
            'lavanderia': 'Lavanderia',
            'limpeza': 'Limpeza',
            'bar': 'Bar',
            'escritorio': 'Escrit√≥rio',
            'area_externa': '√Årea Externa',
            'compras': 'Compras',
            'geral': 'Lista Geral (Administrador)'
        };

        // Lista de produtos organizados por categoria
        const productList = [
            // CEREAIS / FARDOS
            { name: "Arroz", category: "Cereais / Fardos", unit: "kg" },
            { name: "Arroz integral", category: "Cereais / Fardos", unit: "kg" },
            { name: "A√ß√∫car cristal", category: "Cereais / Fardos", unit: "kg" },
            { name: "A√ß√∫car refinado", category: "Cereais / Fardos", unit: "kg" },
            { name: "Aveia em flocos", category: "Cereais / Fardos", unit: "pct" },
            { name: "Aveia fina", category: "Cereais / Fardos", unit: "pct" },
            { name: "Biscoito √°gua e sal", category: "Cereais / Fardos", unit: "pct" },
            { name: "Biscoito maizena", category: "Cereais / Fardos", unit: "pct" },
            { name: "Caf√©", category: "Cereais / Fardos", unit: "pct" },
            { name: "Cevada", category: "Cereais / Fardos", unit: "pct" },
            { name: "Farinha de mandioca", category: "Cereais / Fardos", unit: "kg" },
            { name: "Farinha de quibe", category: "Cereais / Fardos", unit: "g" },
            { name: "Farinha de trigo", category: "Cereais / Fardos", unit: "kg" },
            { name: "Fub√° de milho", category: "Cereais / Fardos", unit: "kg" },
            { name: "Granola", category: "Cereais / Fardos", unit: "pct" },
            { name: "Macarr√£o espaguete", category: "Cereais / Fardos", unit: "pct" },
            { name: "Macarr√£o tipo parafuso", category: "Cereais / Fardos", unit: "pct" },
            { name: "Macarr√£o tipo arinho", category: "Cereais / Fardos", unit: "pct" },
            { name: "Macarr√£o tipo penne", category: "Cereais / Fardos", unit: "pct" },
            { name: "Massa para lasanha", category: "Cereais / Fardos", unit: "pct" },
            { name: "Milho para canjica", category: "Cereais / Fardos", unit: "pct" },
            { name: "Polvilho doce", category: "Cereais / Fardos", unit: "g" },
            { name: "Polvilho azedo", category: "Cereais / Fardos", unit: "g" },
            { name: "Sal refinado", category: "Cereais / Fardos", unit: "pct" },
            { name: "Sal grosso", category: "Cereais / Fardos", unit: "pct" },
            { name: "Feij√£o", category: "Cereais / Fardos", unit: "kg" },
            { name: "Ervilha", category: "Cereais / Fardos", unit: "g" },

            // PROTE√çNAS
            { name: "Atum", category: "Prote√≠nas", unit: "un" },
            { name: "Sardinha", category: "Prote√≠nas", unit: "un" },
            { name: "Ovos", category: "Prote√≠nas", unit: "dz" },
            { name: "Carne mo√≠da", category: "Prote√≠nas", unit: "kg" },
            { name: "Costelinha de porco", category: "Prote√≠nas", unit: "kg" },
            { name: "Pernil", category: "Prote√≠nas", unit: "kg" },
            { name: "Peito de frango", category: "Prote√≠nas", unit: "kg" },
            { name: "Coxa sobrecoxa", category: "Prote√≠nas", unit: "kg" },

            // LATIC√çNIOS
            { name: "Leite integral", category: "Latic√≠nios", unit: "l" },
            { name: "Leite de soja", category: "Latic√≠nios", unit: "l" },
            { name: "Leite condensado", category: "Latic√≠nios", unit: "un" },
            { name: "Leite de coco", category: "Latic√≠nios", unit: "un" },
            { name: "Creme de leite", category: "Latic√≠nios", unit: "un" },
            { name: "Margarina", category: "Latic√≠nios", unit: "un" },
            { name: "Queijo", category: "Latic√≠nios", unit: "kg" },
            { name: "Requeij√£o", category: "Latic√≠nios", unit: "un" },
            { name: "Iogurte", category: "Latic√≠nios", unit: "un" },
            { name: "Chantilly", category: "Latic√≠nios", unit: "un" },

            // FRUTAS
            { name: "Abacate", category: "Frutas", unit: "un" },
            { name: "Abacaxi", category: "Frutas", unit: "un" },
            { name: "Banana da terra", category: "Frutas", unit: "dz" },
            { name: "Banana nanica", category: "Frutas", unit: "dz" },
            { name: "Caqui", category: "Frutas", unit: "kg" },
            { name: "Goiaba", category: "Frutas", unit: "kg" },
            { name: "Kiwi", category: "Frutas", unit: "kg" },
            { name: "Laranja", category: "Frutas", unit: "kg" },
            { name: "Lima", category: "Frutas", unit: "kg" },
            { name: "Lim√£o", category: "Frutas", unit: "kg" },
            { name: "Ma√ß√£", category: "Frutas", unit: "kg" },
            { name: "Mam√£o", category: "Frutas", unit: "un" },
            { name: "Manga", category: "Frutas", unit: "un" },
            { name: "Maracuj√°", category: "Frutas", unit: "kg" },
            { name: "Melancia", category: "Frutas", unit: "un" },
            { name: "Morango", category: "Frutas", unit: "bdj" },
            { name: "Nectarina", category: "Frutas", unit: "kg" },
            { name: "Pera", category: "Frutas", unit: "kg" },
            { name: "P√™ssego", category: "Frutas", unit: "kg" },
            { name: "Tangerina", category: "Frutas", unit: "kg" },
            { name: "Uva", category: "Frutas", unit: "kg" },

            // VERDURAS
            { name: "Acelga", category: "Verduras", unit: "un" },
            { name: "Agri√£o", category: "Verduras", unit: "ma√ßo" },
            { name: "Alface comum", category: "Verduras", unit: "un" },
            { name: "Alface americana", category: "Verduras", unit: "un" },
            { name: "Alface crespa", category: "Verduras", unit: "un" },
            { name: "Almeir√£o", category: "Verduras", unit: "ma√ßo" },
            { name: "Cebolinha verde", category: "Verduras", unit: "ma√ßo" },
            { name: "Chic√≥ria", category: "Verduras", unit: "ma√ßo" },
            { name: "Coentro", category: "Verduras", unit: "ma√ßo" },
            { name: "Couve manteiga", category: "Verduras", unit: "ma√ßo" },
            { name: "Escarola", category: "Verduras", unit: "ma√ßo" },
            { name: "Espinafre", category: "Verduras", unit: "ma√ßo" },
            { name: "R√∫cula", category: "Verduras", unit: "ma√ßo" },
            { name: "Salsinha", category: "Verduras", unit: "ma√ßo" },

            // LEGUMES
            { name: "Ab√≥bora", category: "Legumes", unit: "kg" },
            { name: "Abobrinha verde", category: "Legumes", unit: "kg" },
            { name: "Alho", category: "Legumes", unit: "kg" },
            { name: "Alho por√≥", category: "Legumes", unit: "un" },
            { name: "Batata lavada", category: "Legumes", unit: "kg" },
            { name: "Batata doce", category: "Legumes", unit: "kg" },
            { name: "Berinjela", category: "Legumes", unit: "kg" },
            { name: "Beterraba", category: "Legumes", unit: "kg" },
            { name: "Br√≥colis", category: "Legumes", unit: "un" },
            { name: "Cebola", category: "Legumes", unit: "kg" },
            { name: "Cebola roxa", category: "Legumes", unit: "kg" },
            { name: "Cenoura", category: "Legumes", unit: "kg" },
            { name: "Chuchu", category: "Legumes", unit: "kg" },
            { name: "Couve-flor", category: "Legumes", unit: "un" },
            { name: "Gengibre", category: "Legumes", unit: "kg" },
            { name: "Tomate", category: "Legumes", unit: "kg" },
            { name: "Tomate para molho", category: "Legumes", unit: "kg" },
            { name: "Vagem", category: "Legumes", unit: "kg" },

            // LIMPEZA
            { name: "Detergente", category: "Limpeza", unit: "un" },
            { name: "Sab√£o em p√≥", category: "Limpeza", unit: "kg" },
            { name: "Desinfetante", category: "Limpeza", unit: "l" },
            { name: "√Ågua sanit√°ria", category: "Limpeza", unit: "l" },
            { name: "Esponja", category: "Limpeza", unit: "un" },
            { name: "Papel toalha", category: "Limpeza", unit: "pct" },
            { name: "Saco de lixo", category: "Limpeza", unit: "pct" },

            // BEBIDAS
            { name: "Refrigerante", category: "Bebidas", unit: "l" },
            { name: "Refrigerante Zero", category: "Bebidas", unit: "ml" },
            { name: "√Ågua com g√°s", category: "Bebidas", unit: "ml" },
            { name: "√Ågua sem g√°s", category: "Bebidas", unit: "ml" }
        ];

        // Estado da aplica√ß√£o
        let currentSector = null;
        let currentSectorItems = [];
        let currentInventory = [];
        let history = [];
        let currentHistoryDetails = null;
        let shoppingList = [];
        let purchaseStatus = '';

        // Carregar dados do localStorage
        function loadData() {
            const data = localStorage.getItem('restaurantManagement');
            if (data) {
                const parsed = JSON.parse(data);
                history = parsed.history || [];
                shoppingList = parsed.shoppingList || [];
                
                // Carregar dados espec√≠ficos do setor atual
                if (currentSector) {
                    currentSectorItems = parsed[currentSector + '_items'] || [];
                    currentInventory = parsed[currentSector + '_inventory'] || [];
                }
            }
        }

        // Salvar dados no localStorage
        function saveData() {
            const data = {
                history: history,
                shoppingList: shoppingList
            };
            
            if (currentSector) {
                data[currentSector + '_items'] = currentSectorItems;
                data[currentSector + '_inventory'] = currentInventory;
            }
            
            localStorage.setItem('restaurantManagement', JSON.stringify(data));
        }

        // Mostrar modal de senha
        function showPasswordModal(sector) {
            currentSector = sector;
            document.getElementById('passwordModal').classList.add('active');
            document.getElementById('passwordInput').focus();
        }

        // Autenticar setor
        function authenticate() {
            const password = document.getElementById('passwordInput').value;
            
            if (password === sectorPasswords[currentSector]) {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('mainSystem').style.display = 'block';
                document.getElementById('currentSector').textContent = sectorNames[currentSector];
                document.getElementById('sectorName').textContent = sectorNames[currentSector];
                
                // Mostrar abas espec√≠ficas para cada setor
                if (currentSector === 'compras') {
                    document.getElementById('comprasTab').style.display = 'flex';
                    document.getElementById('receitasTab').style.display = 'none';
                    switchTab('compras');
                } else if (currentSector === 'cozinha') {
                    document.getElementById('comprasTab').style.display = 'none';
                    document.getElementById('receitasTab').style.display = 'flex';
                } else if (currentSector === 'geral') {
                    document.getElementById('comprasTab').style.display = 'none';
                    document.getElementById('receitasTab').style.display = 'none';
                    // Usu√°rio geral pode acessar todas as categorias
                } else {
                    document.getElementById('comprasTab').style.display = 'none';
                    document.getElementById('receitasTab').style.display = 'none';
                }
                
                closeModal('passwordModal');
                loadData();
                updateUI();
                showNotification('Login realizado com sucesso!');
            } else {
                showNotification('Senha incorreta!', 'error');
            }
            
            document.getElementById('passwordInput').value = '';
        }

        // Logout
        function logout() {
            currentSector = null;
            document.getElementById('loginScreen').style.display = 'block';
            document.getElementById('mainSystem').style.display = 'none';
        }

        // Fechar modal
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // Trocar aba
        function switchTab(tab) {
            // Remover active de todas as abas
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
            
            // Ativar aba selecionada
            document.getElementById(tab).classList.add('active');
            
            // Encontrar e ativar a tab correta
            const tabs = document.querySelectorAll('.tab');
            for (let i = 0; i < tabs.length; i++) {
                if (tabs[i].getAttribute('onclick').includes(tab)) {
                    tabs[i].classList.add('active');
                    break;
                }
            }
            
            updateUI();
        }

        // Mostrar sugest√µes de produtos
        function showSuggestions(query, type) {
            const suggestionsContainer = document.getElementById(`${type}Suggestions`);
            
            if (!query || query.length < 2) {
                suggestionsContainer.style.display = 'none';
                suggestionsContainer.innerHTML = '';
                return;
            }
            
            // Filtrar produtos que correspondem √† consulta
            let filteredProducts = productList.filter(product => 
                product.name.toLowerCase().includes(query.toLowerCase())
            );
            
            // Se for usu√°rio geral, mostrar todas as categorias
            // Se for setor espec√≠fico, filtrar por categorias relevantes
            if (currentSector !== 'geral') {
                const sectorCategories = {
                    'cozinha': ['Cereais / Fardos', 'Prote√≠nas', 'Latic√≠nios', 'Frutas', 'Verduras', 'Legumes'],
                    'bar': ['Bebidas'],
                    'limpeza': ['Limpeza'],
                    'lavanderia': ['Limpeza'],
                    'area_externa': ['Cereais / Fardos', 'Bebidas', 'Limpeza'],
                    'escritorio': ['Cereais / Fardos', 'Bebidas', 'Limpeza']
                };
                
                if (sectorCategories[currentSector]) {
                    filteredProducts = filteredProducts.filter(product => 
                        sectorCategories[currentSector].includes(product.category)
                    );
                }
            }
            
            if (filteredProducts.length === 0) {
                suggestionsContainer.style.display = 'none';
                suggestionsContainer.innerHTML = '';
                return;
            }
            
            // Agrupar por categoria
            const groupedByCategory = {};
            filteredProducts.forEach(product => {
                if (!groupedByCategory[product.category]) {
                    groupedByCategory[product.category] = [];
                }
                groupedByCategory[product.category].push(product);
            });
            
            // Construir HTML das sugest√µes
            let suggestionsHTML = '';
            
            for (const category in groupedByCategory) {
                suggestionsHTML += `<div class="suggestion-category">${category}</div>`;
                
                groupedByCategory[category].forEach(product => {
                    suggestionsHTML += `
                        <div class="suggestion-item" onclick="selectSuggestion('${product.name}', '${type}', '${product.unit}')">
                            ${product.name} <span style="color: #666; font-size: 12px;">(${product.unit})</span>
                        </div>
                    `;
                });
            }
            
            suggestionsContainer.innerHTML = suggestionsHTML;
            suggestionsContainer.style.display = 'block';
        }

        // Selecionar uma sugest√£o
        function selectSuggestion(productName, type, unit) {
            if (type === 'item') {
                document.getElementById('itemName').value = productName;
                document.getElementById('itemSuggestions').style.display = 'none';
                
                // Preencher automaticamente a unidade se dispon√≠vel
                if (unit) {
                    document.getElementById('itemUnit').value = unit;
                }
            } else if (type === 'inventory') {
                document.getElementById('inventoryItemName').value = productName;
                document.getElementById('inventorySuggestions').style.display = 'none';
                
                // Preencher automaticamente a unidade se dispon√≠vel
                if (unit) {
                    document.getElementById('inventoryUnit').value = unit;
                }
            }
        }

        // Fechar sugest√µes ao clicar fora
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.form-group')) {
                document.getElementById('itemSuggestions').style.display = 'none';
                document.getElementById('inventorySuggestions').style.display = 'none';
            }
        });

        // Mostrar modal adicionar item
        function showAddItemModal() {
            document.getElementById('addItemModal').classList.add('active');
            document.getElementById('itemName').focus();
        }

        // Mostrar modal adicionar invent√°rio
        function showAddInventoryModal() {
            document.getElementById('addInventoryModal').classList.add('active');
            document.getElementById('inventoryItemName').focus();
        }

        // Adicionar item √† lista
        function addItem() {
            const name = document.getElementById('itemName').value.trim();
            const quantity = document.getElementById('itemQuantity').value;
            const unit = document.getElementById('itemUnit').value;
            const priority = document.getElementById('itemPriority').value;
            const notes = document.getElementById('itemNotes').value.trim();

            if (!name || !quantity) {
                showNotification('Nome e quantidade s√£o obrigat√≥rios!', 'error');
                return;
            }

            const newItem = {
                id: Date.now(),
                name: name,
                quantity: quantity + ' ' + unit,
                priority: priority,
                notes: notes,
                createdAt: new Date().toISOString(),
                sector: currentSector
            };

            currentSectorItems.unshift(newItem);
            saveData();
            updateUI();
            closeModal('addItemModal');
            
            // Limpar formul√°rio
            document.getElementById('itemName').value = '';
            document.getElementById('itemQuantity').value = '';
            document.getElementById('itemUnit').value = 'un';
            document.getElementById('itemPriority').value = 'normal';
            document.getElementById('itemNotes').value = '';
            
            showNotification('Item adicionado com sucesso!');
        }

        // Adicionar item ao invent√°rio
        function addInventoryItem() {
            const name = document.getElementById('inventoryItemName').value.trim();
            const quantity = parseInt(document.getElementById('inventoryQuantity').value) || 0;
            const minQuantity = parseInt(document.getElementById('inventoryMinQuantity').value) || 0;
            const unit = document.getElementById('inventoryUnit').value.trim();

            if (!name) {
                showNotification('Nome do item √© obrigat√≥rio!', 'error');
                return;
            }

            const newItem = {
                id: Date.now(),
                name: name,
                quantity: quantity,
                minQuantity: minQuantity,
                unit: unit,
                sector: currentSector,
                createdAt: new Date().toISOString()
            };

            currentInventory.push(newItem);
            saveData();
            updateUI();
            closeModal('addInventoryModal');
            
            // Limpar formul√°rio
            document.getElementById('inventoryItemName').value = '';
            document.getElementById('inventoryQuantity').value = '';
            document.getElementById('inventoryMinQuantity').value = '';
            document.getElementById('inventoryUnit').value = '';
            
            showNotification('Item adicionado ao invent√°rio!');
        }

        // Deletar item da lista
        function deleteItem(id) {
            if (confirm('Tem certeza que deseja excluir este item?')) {
                currentSectorItems = currentSectorItems.filter(i => i.id !== id);
                saveData();
                updateUI();
                showNotification('Item exclu√≠do!');
            }
        }

        // Deletar item do invent√°rio
        function deleteInventoryItem(id) {
            if (confirm('Tem certeza que deseja excluir este item do invent√°rio?')) {
                currentInventory = currentInventory.filter(i => i.id !== id);
                saveData();
                updateUI();
                showNotification('Item removido do invent√°rio!');
            }
        }

        // Atualizar quantidade no invent√°rio
        function updateInventoryQuantity(id, change) {
            const item = currentInventory.find(i => i.id === id);
            if (item) {
                const newQuantity = Math.max(0, item.quantity + change);
                item.quantity = newQuantity;
                saveData();
                updateUI();
            }
        }

        // Finalizar lista
        function finalizeList() {
            if (currentSectorItems.length === 0) {
                showNotification('N√£o h√° itens na lista!', 'error');
                return;
            }

            if (confirm(`Finalizar lista com ${currentSectorItems.length} itens?`)) {
                const listData = {
                    id: Date.now(),
                    sector: currentSector,
                    sectorName: sectorNames[currentSector],
                    date: new Date().toLocaleDateString('pt-BR'),
                    items: [...currentSectorItems],
                    totalItems: currentSectorItems.length,
                    finalizedAt: new Date().toISOString()
                };

                history.unshift(listData);
                
                // Adicionar √† lista de compras
                currentSectorItems.forEach(item => {
                    shoppingList.push({
                        id: Date.now() + Math.random(),
                        name: item.name,
                        quantity: item.quantity,
                        sector: currentSector,
                        requestedAt: new Date().toISOString()
                    });
                });
                
                currentSectorItems = [];
                saveData();
                updateUI();
                
                showNotification('Lista finalizada e enviada para compras!');
            }
        }

        // Mesclar listas de compras
        function mergeShoppingLists() {
            // J√° estamos fazendo merge autom√°tico quando as listas s√£o finalizadas
            showNotification('Listas do dia j√° est√£o mescladas automaticamente!');
        }

        // Filtrar lista de compras
        function filterShoppingList(filter) {
            const items = document.querySelectorAll('.shopping-list-item');
            
            items.forEach(item => {
                if (filter === 'todos') {
                    item.style.display = 'flex';
                } else {
                    const sector = item.getAttribute('data-sector');
                    if (sector === filter) {
                        item.style.display = 'flex';
                    } else {
                        item.style.display = 'none';
                    }
                }
            });
            
            // Ativar o bot√£o de filtro selecionado
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        // Mostrar modal de status de compra
        function showPurchaseStatusModal(itemId) {
            const item = shoppingList.find(i => i.id === itemId);
            if (!item) return;
            
            document.getElementById('purchaseItemId').value = itemId;
            document.getElementById('purchaseItemTitle').textContent = `Status: ${item.name}`;
            document.getElementById('quantitySection').style.display = 'none';
            document.getElementById('itemPrice').value = '';
            document.getElementById('purchaseNotes').value = '';
            
            document.getElementById('purchaseStatusModal').classList.add('active');
        }

        // Definir status de compra
        function setPurchaseStatus(status) {
            purchaseStatus = status;
            
            if (status === 'parcial') {
                document.getElementById('quantitySection').style.display = 'block';
            } else {
                document.getElementById('quantitySection').style.display = 'none';
            }
        }

        // Salvar status de compra
        function savePurchaseStatus() {
            const itemId = parseFloat(document.getElementById('purchaseItemId').value);
            const price = parseFloat(document.getElementById('itemPrice').value) || 0;
            const notes = document.getElementById('purchaseNotes').value;
            let purchasedQuantity = '';
            let purchasedUnit = '';
            
            if (purchaseStatus === 'parcial') {
                purchasedQuantity = document.getElementById('purchasedQuantity').value;
                purchasedUnit = document.getElementById('purchasedUnit').value;
                if (!purchasedQuantity) {
                    showNotification('Informe a quantidade comprada!', 'error');
                    return;
                }
            }
            
            const itemIndex = shoppingList.findIndex(i => i.id === itemId);
            if (itemIndex !== -1) {
                shoppingList[itemIndex].purchaseStatus = purchaseStatus;
                shoppingList[itemIndex].price = price;
                shoppingList[itemIndex].purchaseNotes = notes;
                
                if (purchaseStatus === 'encontrado' || purchaseStatus === 'parcial') {
                    // Atualizar invent√°rio
                    updateInventoryFromPurchase(shoppingList[itemIndex], purchasedQuantity, purchasedUnit);
                }
                
                saveData();
                updateUI();
                closeModal('purchaseStatusModal');
                showNotification('Status de compra atualizado!');
            }
        }

        // Atualizar invent√°rio a partir da compra
        function updateInventoryFromPurchase(item, purchasedQuantity, purchasedUnit) {
            let quantityToAdd = item.quantity;
            let unitToAdd = item.quantity.split(' ')[1] || 'un';
            
            if (purchaseStatus === 'parcial') {
                quantityToAdd = purchasedQuantity;
                unitToAdd = purchasedUnit;
            }
            
            // Verificar se o item j√° existe no invent√°rio
            const existingItemIndex = currentInventory.findIndex(i => i.name === item.name);
            
            if (existingItemIndex !== -1) {
                // Se existe, atualizar a quantidade (assumindo unidades compat√≠veis)
                currentInventory[existingItemIndex].quantity += parseFloat(quantityToAdd);
            } else {
                // Se n√£o existe, adicionar novo item
                currentInventory.push({
                    id: Date.now(),
                    name: item.name,
                    quantity: parseFloat(quantityToAdd),
                    minQuantity: 5, // Valor padr√£o
                    unit: unitToAdd,
                    sector: 'compras',
                    createdAt: new Date().toISOString()
                });
            }
            
            saveData();
        }

        // Finalizar compra
        function finalizeShopping() {
            const purchasedItems = shoppingList.filter(item => item.purchaseStatus === 'encontrado' || item.purchaseStatus === 'parcial');
            const notFoundItems = shoppingList.filter(item => item.purchaseStatus === 'nao_encontrado');
            const pendingItems = shoppingList.filter(item => !item.purchaseStatus);
            
            if (pendingItems.length > 0) {
                showNotification('Existem itens sem status de compra!', 'error');
                return;
            }
            
            // Adicionar ao hist√≥rico
            const shoppingData = {
                id: Date.now(),
                date: new Date().toLocaleDateString('pt-BR'),
                purchasedItems: purchasedItems,
                notFoundItems: notFoundItems,
                finalizedAt: new Date().toISOString()
            };
            
            history.unshift(shoppingData);
            shoppingList = [];
            saveData();
            updateUI();
            
            showNotification('Compra finalizada e salva no hist√≥rico!');
        }

        // Compartilhar lista de compras via WhatsApp
        function shareShoppingList() {
            const purchasedItems = shoppingList.filter(item => item.purchaseStatus === 'encontrado' || item.purchaseStatus === 'parcial');
            const notFoundItems = shoppingList.filter(item => item.purchaseStatus === 'nao_encontrado');
            
            if (purchasedItems.length === 0 && notFoundItems.length === 0) {
                showNotification('N√£o h√° itens para compartilhar!', 'error');
                return;
            }
            
            // Formatar a mensagem para o WhatsApp
            let message = `*LISTA DE COMPRAS - ${new Date().toLocaleDateString('pt-BR')}*\n\n`;
            
            if (purchasedItems.length > 0) {
                message += `*ITENS COMPRADOS:*\n`;
                purchasedItems.forEach(item => {
                    message += `‚úÖ ${item.name} - ${item.quantity}`;
                    if (item.price) {
                        message += ` - R$ ${item.price.toFixed(2)}`;
                    }
                    message += '\n';
                });
                message += '\n';
            }
            
            if (notFoundItems.length > 0) {
                message += `*ITENS N√ÉO ENCONTRADOS:*\n`;
                notFoundItems.forEach(item => {
                    message += `‚ùå ${item.name} - ${item.quantity}\n`;
                });
            }
            
            // Codificar a mensagem para URL
            const encodedMessage = encodeURIComponent(message);
            
            // Gerar o link do WhatsApp
            const whatsappUrl = `https://wa.me/?text=${encodedMessage}`;
            
            // Abrir o WhatsApp em uma nova janela/aba
            window.open(whatsappUrl, '_blank');
        }

        // Gerar receitas com IA (simulado)
        function generateRecipes() {
            // Esta √© uma simula√ß√£o - em um sistema real, isso se conectaria a uma API de IA
            const availableItems = currentInventory.map(item => item.name).join(', ');
            
            // Receitas pr√©-definidas baseadas nos itens dispon√≠veis
            const recipes = [
                {
                    title: "Risoto de Frango com Legumes",
                    ingredients: "Arroz, frango, cenoura, vagem, cebola, alho, queijo",
                    instructions: "Cozinhe o frango e desfie. Refogue os legumes, adicione o arroz e caldo de galinha. Acrescente o frango e finalize com queijo."
                },
                {
                    title: "Salada Mediterr√¢nea",
                    ingredients: "Alface, tomate, pepino, queijo feta, azeitonas, azeite de oliva",
                    instructions: "Corte todos os ingredientes em cubos, misture e tempere com azeite, sal e lim√£o."
                },
                {
                    title: "Smoothie Energ√©tico",
                    ingredients: "Banana, morango, iogurte, aveia, mel",
                    instructions: "Bata todos os ingredientes no liquidificador at√© obter uma consist√™ncia homog√™nea. Sirva gelado."
                }
            ];
            
            const recipesList = document.getElementById('recipesList');
            recipesList.innerHTML = '';
            
            recipes.forEach(recipe => {
                recipesList.innerHTML += `
                    <div class="recipe-card">
                        <div class="recipe-title">${recipe.title}</div>
                        <div class="recipe-ingredients"><strong>Ingredientes:</strong> ${recipe.ingredients}</div>
                        <div class="recipe-instructions"><strong>Modo de preparo:</strong> ${recipe.instructions}</div>
                    </div>
                `;
            });
            
            showNotification('Receitas geradas com base nos itens dispon√≠veis!');
        }

        // Ver detalhes do hist√≥rico
        function viewHistoryDetails(id) {
            const list = history.find(h => h.id === id);
            if (!list) return;

            currentHistoryDetails = list;
            
            document.getElementById('historyDetailsTitle').textContent = `Lista do dia ${list.date}`;
            
            let detailsHTML = `
                <div style="margin-bottom: 15px;">
                    <strong>Setor:</strong> ${list.sectorName}<br>
                    <strong>Finalizada √†s:</strong> ${new Date(list.finalizedAt).toLocaleString('pt-BR')}<br>
                    <strong>Itens:</strong> ${list.totalItems} itens
                </div>
                <div style="max-height: 300px; overflow-y: auto;">
                    <h4 style="margin-bottom: 10px;">Itens:</h4>
            `;
            
            list.items.forEach(item => {
                const priority = item.priority === 'urgente' ? 'üî¥' : item.priority === 'alta' ? 'üü°' : 'üü¢';
                
                detailsHTML += `
                    <div class="history-item">
                        <div class="history-item-details">
                            <div>${item.name}</div>
                            <div>${priority}</div>
                        </div>
                        <div>Quantidade: ${item.quantity}</div>
                        ${item.notes ? `<div class="history-item-notes">Observa√ß√µes: ${item.notes}</div>` : ''}
                    </div>
                `;
            });
            
            detailsHTML += '</div>';
            document.getElementById('historyDetailsContent').innerHTML = detailsHTML;
            document.getElementById('historyDetailsModal').classList.add('active');
        }

        // Compartilhar lista via WhatsApp
        function shareToWhatsApp() {
            if (!currentHistoryDetails) return;
            
            const list = currentHistoryDetails;
            
            // Formatar a mensagem para o WhatsApp
            let message = `*LISTA DO DIA ${list.date} - ${list.sectorName.toUpperCase()}*\n\n`;
            message += `*Itens: ${list.totalItems} itens*\n\n`;
            
            list.items.forEach(item => {
                const priority = item.priority === 'urgente' ? 'üî¥ URGENTE' : item.priority === 'alta' ? 'üü° ALTA' : 'üü¢ NORMAL';
                
                message += `*${item.name}* - ${item.quantity} ${priority}\n`;
                
                if (item.notes) {
                    message += `Observa√ß√µes: ${item.notes}\n`;
                }
                
                message += '\n';
            });
            
            message += `\n*Sistema de Gest√£o - Restaurante*`;
            
            // Codificar a mensagem para URL
            const encodedMessage = encodeURIComponent(message);
            
            // Gerar o link do WhatsApp
            const whatsappUrl = `https://wa.me/?text=${encodedMessage}`;
            
            // Abrir o WhatsApp em uma nova janela/aba
            window.open(whatsappUrl, '_blank');
        }

        // Deletar hist√≥rico
        function deleteHistory(id) {
            if (confirm('Tem certeza que deseja excluir este hist√≥rico?')) {
                history = history.filter(h => h.id !== id);
                saveData();
                updateUI();
                showNotification('Hist√≥rico exclu√≠do!');
            }
        }

        // Renderizar lista de itens
        function renderItems() {
            const container = document.getElementById('itemsList');
            
            if (currentSectorItems.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: #6c757d;">Nenhum item na lista</div>';
                return;
            }

            container.innerHTML = currentSectorItems.map(item => `
                <div class="item-card">
                    <div class="item-header">
                        <div class="item-name">${item.name}</div>
                    </div>
                    
                    <div class="item-details">
                        <span>üì¶ ${item.quantity}</span>
                        <span class="priority priority-${item.priority}">
                            ${item.priority === 'urgente' ? 'üî¥' : item.priority === 'alta' ? 'üü°' : 'üü¢'} 
                            ${item.priority.charAt(0).toUpperCase() + item.priority.slice(1)}
                        </span>
                    </div>
                    
                    ${item.notes ? `<div style="margin: 10px 0; font-size: 14px; color: #666;">üí¨ ${item.notes}</div>` : ''}
                    
                    <div class="item-actions">
                        <button class="btn btn-small btn-danger" onclick="deleteItem(${item.id})">üóëÔ∏è</button>
                    </div>
                </div>
            `).join('');
        }

        // Renderizar invent√°rio
        function renderInventory() {
            const container = document.getElementById('inventoryList');
            
            if (currentInventory.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: #6c757d;">Nenhum item no invent√°rio</div>';
                return;
            }

            container.innerHTML = currentInventory.map(item => {
                let statusClass = '';
                let statusIcon = '';
                
                if (item.quantity === 0) {
                    statusClass = 'out-of-stock';
                    statusIcon = 'üî¥';
                } else if (item.quantity <= item.minQuantity) {
                    statusClass = 'low-stock';
                    statusIcon = 'üü°';
                } else {
                    statusIcon = 'üü¢';
                }
                
                return `
                    <div class="inventory-item ${statusClass}">
                        <div>
                            <div style="font-weight: bold;">${statusIcon} ${item.name}</div>
                            <div style="font-size: 12px; color: #666;">M√≠n: ${item.minQuantity} ${item.unit}</div>
                        </div>
                        
                        <div class="quantity-controls">
                            <button class="quantity-btn btn-danger" onclick="updateInventoryQuantity(${item.id}, -1)">-</button>
                            <div class="quantity-display">${item.quantity} ${item.unit}</div>
                            <button class="quantity-btn btn-success" onclick="updateInventoryQuantity(${item.id}, 1)">+</button>
                            <button class="btn btn-small btn-danger" onclick="deleteInventoryItem(${item.id})">üóëÔ∏è</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Renderizar hist√≥rico
        function renderHistory() {
            const container = document.getElementById('historyList');
            
            const sectorHistory = history.filter(h => h.sector === currentSector);
            
            if (sectorHistory.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: #6c757d;">Nenhum hist√≥rico encontrado</div>';
                return;
            }

            container.innerHTML = sectorHistory.map(list => `
                <div class="item-card">
                    <div class="item-header">
                        <div class="item-name">Lista do dia ${list.date}</div>
                        <div style="font-size: 14px; color: #666;">${list.totalItems} itens</div>
                    </div>
                    
                    <div class="item-details">
                        <span>üìÖ ${new Date(list.finalizedAt).toLocaleTimeString('pt-BR', {hour: '2-digit', minute: '2-digit'})}</span>
                        <span>üè¢ ${list.sectorName}</span>
                    </div>
                    
                    <div class="item-actions">
                        <button class="btn btn-small" onclick="viewHistoryDetails(${list.id})">üëÅÔ∏è Ver</button>
                        <button class="btn btn-small btn-danger" onclick="deleteHistory(${list.id})">üóëÔ∏è</button>
                    </div>
                </div>
            `).join('');
        }

        // Renderizar lista de compras
        function renderShoppingList() {
            const container = document.getElementById('shoppingList');
            
            if (shoppingList.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: #6c757d;">Nenhum item na lista de compras</div>';
                return;
            }
            
            container.innerHTML = shoppingList.map(item => {
                let statusBadge = '';
                if (item.purchaseStatus === 'encontrado') {
                    statusBadge = '<span style="color: green; font-weight: bold;">‚úÖ Comprado</span>';
                } else if (item.purchaseStatus === 'nao_encontrado') {
                    statusBadge = '<span style="color: red; font-weight: bold;">‚ùå N√£o encontrado</span>';
                } else if (item.purchaseStatus === 'parcial') {
                    statusBadge = '<span style="color: orange; font-weight: bold;">üîÑ Quantidade diferente</span>';
                }
                
                return `
                    <div class="shopping-list-item" data-sector="${item.sector}">
                        <div class="shopping-item-info">
                            <div class="shopping-item-name">${item.name} <small>(${sectorNames[item.sector]})</small></div>
                            <div class="shopping-item-quantity">Quantidade: ${item.quantity} ${statusBadge}</div>
                            ${item.price ? `<div>Pre√ßo: R$ ${item.price.toFixed(2)}</div>` : ''}
                            ${item.purchaseNotes ? `<div>Observa√ß√µes: ${item.purchaseNotes}</div>` : ''}
                        </div>
                        <div class="shopping-item-actions">
                            <button class="btn btn-small btn-info" onclick="showPurchaseStatusModal(${item.id})">
                                ${item.purchaseStatus ? 'Editar' : 'Status'}
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Atualizar estat√≠sticas
        function updateStats() {
            const totalItems = currentSectorItems.length;

            document.getElementById('totalItems').textContent = totalItems;
            document.getElementById('pendingItems').textContent = totalItems;

            // Estat√≠sticas do invent√°rio
            const totalInventory = currentInventory.length;
            const lowStockItems = currentInventory.filter(i => i.quantity <= i.minQuantity && i.quantity > 0).length;
            const outOfStockItems = currentInventory.filter(i => i.quantity === 0).length;

            document.getElementById('totalInventory').textContent = totalInventory;
            document.getElementById('lowStockItems').textContent = lowStockItems;
            document.getElementById('outOfStockItems').textContent = outOfStockItems;
        }

        // Atualizar interface
        function updateUI() {
            updateStats();
            renderItems();
            renderInventory();
            renderHistory();
            
            if (currentSector === 'compras') {
                renderShoppingList();
            }
        }

        // Mostrar notifica√ß√£o
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.background = type === 'error' ? 'var(--vermelho)' : 'var(--verde-escuro)';
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Event listeners
        document.addEventListener('keydown', function(e) {
            // Enter no modal de senha
            if (e.key === 'Enter' && document.getElementById('passwordModal').classList.contains('active')) {
                authenticate();
            }
            
            // ESC para fechar modals
            if (e.key === 'Escape') {
                document.querySelectorAll('.modal.active').forEach(modal => {
                    modal.classList.remove('active');
                });
            }
        });

        // Fechar modal clicando fora
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.classList.remove('active');
                }
            });
        });

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
        });
    </script>
</body>
</html>